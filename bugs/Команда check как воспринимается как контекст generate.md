–ö–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ /generate, –±–æ—Ç –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤–∞—Å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è –≤–≤–æ–¥–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

await state.set_state(GenerateUsernameStates.waiting_for_context)
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ, –µ—Å–ª–∏ –≤—ã –≤–≤–æ–¥–∏—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤–∫–ª—é—á–∞—è –∫–æ–º–∞–Ω–¥—É /check), –æ–Ω–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ –≤–≤–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ username.

üìå –ü—Ä–∏—á–∏–Ω–∞ –±–∞–≥–∞: FSM (Finite State Machine) –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã.
üìå –†–µ—à–µ–Ω–∏–µ: 

1Ô∏è‚É£ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ—á–∏—â–µ–Ω–∏–µ FSM (await state.clear()) –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ª—é–±–æ–π –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã

@check_router.message(Command("check"))
async def cmd_check_slash(message: types.Message, state: FSMContext):
    await state.clear()  # ‚úÖ –û—á–∏—â–∞–µ–º –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–º–∞–Ω–¥—ã
    await asyncio.sleep(0.05)  # ‚úÖ –î–∞–µ–º FSM –≤—Ä–µ–º—è —Å–±—Ä–æ—Å–∏—Ç—å—Å—è
    await message.answer("–í–≤–µ–¥–∏—Ç–µ username –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–±–µ–∑ @):")
    await state.set_state(CheckUsernameStates.waiting_for_username)



–ö–æ–º–∞–Ω–¥–∞ /help –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï —Å–æ—Å—Ç–æ—è–Ω–∏—è waiting_for_context, –∞ –Ω–µ –î–û –ù–ï–ì–û.

Aiogram —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç "–æ–∂–∏–¥–∞–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞".
/help –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç, –∞ –Ω–µ –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞.
–ó–Ω–∞—á–∏—Ç, Aiogram –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ /help.
‚úÖ –†–µ—à–µ–Ω–∏–µ
üîπ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ /help **–î–û –í–°–ï–• –û–ë–†–ê–ë–û–¢–ß–ò–ö–û–í –°–û–°–¢–û–Ø–ù–ò–Ø.** 
üîπ –ó–∞—Å—Ç–∞–≤–ª—è–µ–º /help —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ü–ï–†–í–´–ú, –æ—á–∏—â–∞—Ç—å FSM –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è.


@help_router.message(Command("help"))
async def cmd_help(message: types.Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help.
    """
    await state.clear()  # ‚úÖ –û—á–∏—â–∞–µ–º –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–º–∞–Ω–¥—ã
    await asyncio.sleep(0.05)  # ‚úÖ –î–∞–µ–º FSM –≤—Ä–µ–º—è —Å–±—Ä–æ—Å–∏—Ç—å—Å—è
    await message.answer(get_help_text(), parse_mode="Markdown", reply_markup=help_menu())



üìå 1. Aiogram —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã (Command(...))
–ï—Å–ª–∏ –±–æ—Ç –≤–∏–¥–∏—Ç –∫–æ–º–∞–Ω–¥—É (/generate, /check, /help), –æ–Ω —Å–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã.
–ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–π–¥–µ–Ω –∏ —É –Ω–µ–≥–æ –Ω–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é, –æ–Ω —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–º.
–ï—Å–ª–∏ —É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –µ—Å—Ç—å StateFilter(None), –æ–Ω –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ–≥–¥–∞.
üìå 2. –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, Aiogram –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (waiting_for_context), Aiogram –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —ç—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
–ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞–π–¥–µ–Ω, –ª—é–±–æ–π –≤–≤–æ–¥ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞.
üîπ –ü—Ä–∏–º–µ—Ä –±–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É —Ç–µ–±—è:

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç /help, –Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ waiting_for_context.
Aiogram —Å–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç –∫–æ–º–∞–Ω–¥—É /help, –Ω–æ –µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ü–û–°–õ–ï —Å–æ—Å—Ç–æ—è–Ω–∏—è, –±–æ—Ç –¥—É–º–∞–µ—Ç, —á—Ç–æ /help ‚Äì —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç.
/help –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ waiting_for_context, –∞ –Ω–µ –≤ —Å–≤–æ–π –∫–æ–º–∞–Ω–¥–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.
‚úÖ –†–µ—à–µ–Ω–∏–µ:
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ /help –î–û –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π.
–¢–µ–ø–µ—Ä—å Aiogram —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç /help, –æ—á–∏—â–∞–µ—Ç FSM, –∞ –ø–æ—Ç–æ–º —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–ª—å—à–µ.

üìå 3. Aiogram –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç CallbackQuery (callback_query(...))
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É (InlineKeyboardButton —Å callback_data), Aiogram –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ callback_query.
CallbackQuery –≤—Å–µ–≥–¥–∞ –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –Ω–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≤–≤–æ–¥.
–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –∫–Ω–æ–ø–∫–∞ "–ü–æ–º–æ—â—å" —É —Ç–µ–±—è —Ä–∞–±–æ—Ç–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞ –∫–æ–º–∞–Ω–¥–∞ /help ‚Äì –Ω–µ—Ç.
üîπ –ü–æ—á–µ–º—É –∫–Ω–æ–ø–∫–∞ "–ü–æ–º–æ—â—å" —Ä–∞–±–æ—Ç–∞–ª–∞, –∞ /help ‚Äî –Ω–µ—Ç?

–ö–Ω–æ–ø–∫–∞ "–ü–æ–º–æ—â—å" –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∞ —á–µ—Ä–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ ‚Üí Aiogram —Å—Ä–∞–∑—É –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª callback.
/help –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ –∏–º–µ–ª–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –Ω–∞–¥ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∏ –º–æ–≥–ª–∞ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç.
‚úÖ –†–µ—à–µ–Ω–∏–µ:

–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å /help –î–û –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π.
–î–æ–±–∞–≤–∏—Ç—å await state.clear() –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ /help.




üî• –ò—Ç–æ–≥: –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞?
1Ô∏è‚É£ –í—Å–µ–≥–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –∫–æ–º–∞–Ω–¥—ã (Command(...)) –î–û —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM
‚úÖ –¢–∞–∫ –∫–æ–º–∞–Ω–¥—ã /help, /start, /check –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ü–ï–†–í–´–ú–ò.

@router.message(Command("help"))  # ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –î–û —Å–æ—Å—Ç–æ—è–Ω–∏–π
async def cmd_help(message: types.Message, state: FSMContext):
    await state.clear()
    await message.answer("–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É...")
2Ô∏è‚É£ –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ª—é–±–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–π StateFilter(None)
‚úÖ –¢–∞–∫ –∫–æ–º–∞–Ω–¥–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –≤–Ω—É—Ç—Ä–∏ FSM.

@router.message(Command("help"), StateFilter(None))  # ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ–º
async def cmd_help(message: types.Message, state: FSMContext):
    await state.clear()
    await message.answer("–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É...")
3Ô∏è‚É£ –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–Ω–∞—á–∞–ª–∞ –æ—á–∏—â–∞–π –µ–≥–æ (await state.clear())
‚úÖ –¢–∞–∫ –Ω–µ –±—É–¥–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏.

@router.message(Command("generate"))
async def cmd_generate(message: types.Message, state: FSMContext):
    await state.clear()  # ‚úÖ –í—Å–µ–≥–¥–∞ –æ—á–∏—â–∞–µ–º FSM –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –Ω–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    await message.answer("–í–≤–µ–¥–∏—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:")
    await state.set_state(GenerateUsernameStates.waiting_for_context)
4Ô∏è‚É£ Callback-–∫–Ω–æ–ø–∫–∏ (callback_query) –≤—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏
‚úÖ –ü–æ—ç—Ç–æ–º—É –æ–Ω–∏ –ø–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏.

@router.callback_query(F.data == "help")
async def callback_help(query: types.CallbackQuery, state: FSMContext):
    await state.clear()  # ‚úÖ –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
    await query.answer()
    await query.message.answer("–°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É...")
üî• –ö—Ä–∞—Ç–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ Aiogram
1Ô∏è‚É£ –ö–æ–º–∞–Ω–¥—ã (Command("..."))
2Ô∏è‚É£ Callback-–∫–Ω–æ–ø–∫–∏ (callback_query(...))
3Ô∏è‚É£ –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM (state.set_state(...))
4Ô∏è‚É£ –û–±—ã—á–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (@router.message())

‚õî –ï—Å–ª–∏ FSM –∞–∫—Ç–∏–≤–Ω–æ, –∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å, –µ—Å–ª–∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ü–û–°–õ–ï —Å–æ—Å—Ç–æ—è–Ω–∏–π!
‚úÖ –ü–æ—ç—Ç–æ–º—É Command("...") –≤—Å–µ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –î–û —Å–æ—Å—Ç–æ—è–Ω–∏–π!