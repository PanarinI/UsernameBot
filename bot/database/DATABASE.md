–ë–∞–∑–∞ - —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –æ—Ç–≤–µ—Ç–æ–≤.
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ username –∏  —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: status, category, context.
Category - —ç—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è AI –∏—Å—Ö–æ–¥—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞




üìå –¢–∞–±–ª–∏—Ü–∞ generated_usernames
–ü–æ–ª–µ	–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö	–û–ø–∏—Å–∞–Ω–∏–µ
id	SERIAL PRIMARY KEY	–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏
username	VARCHAR(32) UNIQUE	–°–∞–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π username
status	TEXT	–°—Ç–∞—Ç—É—Å (–°–≤–æ–±–æ–¥–Ω–æ, –ó–∞–Ω—è—Ç–æ, –ü—Ä–æ–¥–∞–Ω–æ, –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ø–æ–∫—É–ø–∫–∏, –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å)
tag	TEXT	–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–∏–∑–Ω–µ—Å, —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ç. –¥.)
context	TEXT	–ò—Å—Ö–æ–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
created_at	TIMESTAMP DEFAULT CURRENT_TIMESTAMP	–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏


‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

–ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ username, –¥–∞–∂–µ —Ç–µ, —á—Ç–æ –±—ã–ª–∏ –∑–∞–Ω—è—Ç—ã.
–ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (SELECT tag, COUNT(*) FROM generated_usernames GROUP BY tag).
–ú–æ–∂–Ω–æ –∏—Å–∫–ª—é—á–∞—Ç—å —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–º–µ–Ω–∞, —á—Ç–æ–±—ã AI –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª –∏—Ö (SELECT username FROM generated_usernames WHERE status = '–°–≤–æ–±–æ–¥–Ω–æ').
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ –±—É–¥—É—â–µ–º.


üìå –û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∑–∞–ø–∏—Å–∏ –≤ –ë–î:

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å ‚Üí AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç username.
–ö–∞–∂–¥—ã–π username –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç—å (API Telegram ‚Üí Fragment).
–í—Å–µ username + –∏—Ö —Å—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î (–≤–∫–ª—é—á–∞—è –∑–∞–Ω—è—Ç—ã–µ).
AI –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∫–∞–∂–¥–æ–º—É username –∫–∞—Ç–µ–≥–æ—Ä–∏—é (—Ç—ç–≥) –∏ —Ç–æ–∂–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ë–î.
–¢–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã–µ username –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.



async def connect_to_db():
    return await asyncpg.connect(
        database="my_telegram_bot",  # –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        user="my_user",              # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PostgreSQL
        password="my_password",      # –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        host="localhost"             # –°–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ ‚Äî localhost)
    )







–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º username (AI) ‚Üí generate_usernames(context)
–ü–æ–ª—É—á–∞–µ–º —Ç—ç–≥ –æ—Ç AI (–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é)
–ü—Ä–æ–≤–µ—Ä—è–µ–º username —á–µ—Ä–µ–∑ API ‚Üí check_username_availability(bot, username)
–ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ë–î:

INSERT INTO generated_usernames (username, status, tag, created_at)
VALUES ('ArchNova', '–°–≤–æ–±–æ–¥–Ω–æ', '–±–∏–∑–Ω–µ—Å', NOW());







1Ô∏è‚É£ –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë–º username?

usernames = await generate_usernames(context, n=config.GENERATED_USERNAME_COUNT) 

–ª–æ–≤–∏–º –º–æ–º–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ —Å—Ä–∞–∑—É –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –±–∞–∑—É.

2Ô∏è‚É£ –û—Ç–∫—É–¥–∞ –±–µ—Ä—ë–º —Å—Ç–∞—Ç—É—Å username?
result = await check_username_availability(bot, username)
–∑–∞–ø–∏—à–µ–º username –≤ –ë–î —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –µ–≥–æ —Å—Ç–∞—Ç—É—Å.

3Ô∏è‚É£ –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ç—ç–≥ (–∫–∞—Ç–µ–≥–æ—Ä–∏—é)?
 AI —Å–∞–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—ç–≥.

–í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏ "–ü—Ä–∏–¥—É–º–∞–π username" –≤ –ø—Ä–æ–º–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è "–û–ø—Ä–µ–¥–µ–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é".
OpenAI API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ username, –Ω–æ –∏ —Ç—ç–≥:

{
  "usernames": ["ArchNova", "UrbanStyle"],
  "tag": "–±–∏–∑–Ω–µ—Å"
}



